<div [ngClass]="{'filter blur-sm grayscale pointer-events-none select-none': selectedFormation || selectedExperience}">

  <div class="flex flex-col md:flex-row gap-4 p-4">
    <!-- Formations (gauche) -->
    <div class="flex-1 basis-1/2 p-3 bg-neutral-200 dark:bg-neutral-800">
      <div class="container p-3 text-center">
        <h2 class="text-2xl font-bold text-red-400 dark:text-green-300">Formation</h2>
      </div>
      <div class="container p-4 text-justify space-y-3 font-oxanium">
        <div *ngFor="let group of formationsByDate" class="mb-6">
          <h3 class="text-2xl font-bold text-center text-red-400 dark:text-green-300 mb-2">{{ group.date }}</h3>
          <div class="grid grid-cols-1 gap-2 w-full">
            <div
              class="cursor-pointer card bg-neutral-50 dark:bg-neutral-700 rounded-lg shadow-md overflow-hidden flex flex-col transform transition-transform duration-200 hover:scale-102 darkt:text-gray-400"
              *ngFor="let formation of group.items" (click)="openFormationModal(formation)">
              <div class="p-4 flex-grow">
                <h5 class="text-lg font-bold text-center mb-2">{{ formation.diplome }}</h5>
                <h4 class="text-lg text-center mb-2">{{ formation.mention }}</h4>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Expériences (droite) -->
    <div class="flex-1 basis-1/2 p-3 bg-neutral-200 dark:bg-neutral-800">
      <div class="container p-3 text-center">
        <h2 class="font-bold text-2xl text-indigo-500 dark:text-yellow-200">Experience</h2>
      </div>
      <div class="container p-4 pt-10 text-justify space-y-3 font-oxanium">
        <!-- Liste des -->
        <div class="grid grid-cols-1 gap-2 w-full mt-4">
          <div
            class="cursor-pointer card bg-neutral-50 dark:bg-neutral-700 opacity-90 hover:opacity-100 rounded-lg shadow-md overflow-hidden flex flex-col transform transition-transform duration-200 hover:scale-102"
            *ngFor="let experience of experiences ; let i = index" (click)="openExperienceModal(experience)">
            <div class="p-4 flex-grow text">
              <!-- Poste -->
              <h4 class="text-lg font-bold font-bold text-center mb-2">{{ experience.poste }}
              </h4>
              <!-- Employeur -->
              <h5 class="text-lg text-center mb-2">{{ experience.employeur }}
              </h5>
              <!-- Dates -->
              <h5 class="text-lg text-center mb-2">{{ experience.datedeb.slice(0, 4) }} - {{ experience.datefin === 'présent' ? 'présent' : experience.datefin.slice(0, 4) }}</h5>
              <span
                *ngIf="getExperienceDuration(experience.datedeb, (experience.datefin && experience.datefin !== 'présent') ? experience.datefin : getDateActuelle())"
                class="block text-center text-sm">
                {{ getExperienceDuration(experience.datedeb, (experience.datefin && experience.datefin !== 'présent') ?
                experience.datefin : getDateActuelle()) }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


  <!-- Formation Modal -->
  <div *ngIf="selectedFormation" class="fixed inset-0 z-50 flex items-center justify-center" (click)="closeModal()">
    <div class="bg-neutral-100 dark:bg-neutral-700 rounded-lg shadow-lg p-6 max-w-lg w-full relative"
      (click)="$event.stopPropagation()">
      <button class="absolute top-2 right-2 text-2xl" (click)="closeModal()">&times;</button>
      <h3 class="text-2xl text-center font-bold mb-2">{{ selectedFormation.date }}</h3>
      <h4 class="text-xl text-center font-bold mb-2">{{ selectedFormation.diplome }}</h4>
      <h4 class="text-xl text-center font-semibold mb-2">{{ selectedFormation.mention }}</h4>
      <h5 class="text-lg text-center font-semibold mb-2">{{ selectedFormation.etablissement }}</h5>
      <p class="mb-4 text-justify">{{ selectedFormation.description }}</p>
      <div *ngIf="selectedFormation.link" class="text-center text-blue-500">
        <a [href]="selectedFormation.link.url" target="_blank" rel="noopener noreferrer">{{ selectedFormation.link.text
          }}</a>
      </div>
    </div>
  </div>

  <!-- Experience Modal -->
  <div *ngIf="selectedExperience" class="fixed inset-0 z-50 flex items-center justify-center" (click)="closeModal()">
    <div class="bg-neutral-100 dark:bg-neutral-700 rounded-lg shadow-lg p-6 max-w-lg w-full relative"
      (click)="$event.stopPropagation()">
      <button class="absolute top-2 right-2 text-2xl" (click)="closeModal()">&times;</button>
      <h3 class="text-2xl mb-2 text-center font-bold">{{ selectedExperience.poste }}</h3>
      <h5 class="text-lg font-semibold mb-2 text-center">{{ selectedExperience.employeur }}</h5>
      <h3 class="text-lg mb-2 text-center">{{ selectedExperience.datedeb.slice(0, 4) }} - {{ selectedExperience.datefin === 'présent' ? 'présent' : selectedExperience.datefin.slice(0, 4) }} </h3>
      <p class="mb-4 text-justify">{{ selectedExperience.description }}</p>
    </div>
  </div>
